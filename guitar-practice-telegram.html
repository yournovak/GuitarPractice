<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ðŸŽ¸ ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ¸</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }
        .dark-theme { background: linear-gradient(to bottom right, #1a1a2e, #16213e) !important; color: #e0e0e0; }
        .dark-theme .bg-white { background: #2d2d2d !important; color: #e0e0e0 !important; }
        .dark-theme .bg-gray-50 { background: #383838 !important; color: #e0e0e0 !important; }
        .dark-theme .bg-gray-100 { background: #404040 !important; color: #e0e0e0 !important; }
        .dark-theme .from-amber-50, .dark-theme .from-orange-50, .dark-theme .from-purple-50, .dark-theme .from-blue-50, .dark-theme .from-green-50, .dark-theme .from-red-50, .dark-theme .from-indigo-50, .dark-theme .from-yellow-100, .dark-theme .to-orange-100 { background: #3a3a3a !important; }
        .dark-theme .bg-purple-50, .dark-theme .bg-orange-50, .dark-theme .bg-blue-50, .dark-theme .bg-indigo-50, .dark-theme .bg-green-50, .dark-theme .bg-teal-50, .dark-theme .bg-red-50 { background: #3a3a3a !important; color: #e0e0e0 !important; }
        .dark-theme .text-gray-700, .dark-theme .text-gray-800, .dark-theme .text-gray-900 { color: #e0e0e0 !important; }
        .dark-theme .text-gray-600 { color: #b0b0b0 !important; }
        .dark-theme .text-gray-500 { color: #999 !important; }
        .dark-theme .border-gray-200, .dark-theme .border-gray-300 { border-color: #555 !important; }
        .dark-theme input, .dark-theme textarea { background: #383838 !important; color: #e0e0e0 !important; border-color: #555 !important; }
        .dark-theme .border { border-color: #555 !important; }
        .dark-theme .bg-gradient-to-r { background: #3a3a3a !important; }
        .dark-theme .bg-clip-text { -webkit-background-clip: text !important; background-clip: text !important; }
        .dark-theme .from-purple-600.to-orange-600 { background: linear-gradient(to right, #9333ea, #ea580c) !important; -webkit-background-clip: text !important; background-clip: text !important; }
        .dark-theme .bg-clip-text { -webkit-background-clip: text !important; background-clip: text !important; }
        .dark-theme h1 { background: linear-gradient(to right, #a78bfa, #fb923c) !important; -webkit-background-clip: text !important; background-clip: text !important; }
        .dark-theme .bg-gray-200 { background: #4a4a4a !important; }
        .dark-theme .from-purple-50.to-orange-50 { background: linear-gradient(to right, rgba(147, 51, 234, 0.2), rgba(234, 88, 12, 0.2)) !important; }
        .calendar-day { cursor: pointer; transition: all 0.2s; }
        .calendar-day:hover { transform: scale(1.05); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .dark-theme .calendar-day:hover { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const tg = window.Telegram?.WebApp || { CloudStorage: null, initDataUnsafe: { user: {} } };
        if (tg.expand) tg.expand();

        const GuitarPracticeApp = () => {
            const [currentDate, setCurrentDate] = useState(new Date());
            const [practiceData, setPracticeData] = useState({});
            const [selectedDate, setSelectedDate] = useState(null);
            const [showModal, setShowModal] = useState(false);
            const [currentTab, setCurrentTab] = useState('calendar');
            const [darkTheme, setDarkTheme] = useState(false);
            const [learnedSongs, setLearnedSongs] = useState([]);
            const [toLearnSongs, setToLearnSongs] = useState([]);
            const [dailyQuote, setDailyQuote] = useState('');
            const [loading, setLoading] = useState(true);
            const [userProfile, setUserProfile] = useState({ username: '', avatar: '', registrationDate: new Date().toISOString(), lastLogin: new Date().toISOString() });
            const [friends, setFriends] = useState([]);
            const [friendRequests, setFriendRequests] = useState([]);
            const [searchFriendName, setSearchFriendName] = useState('');
            const [viewingFriend, setViewingFriend] = useState(null);
            const [notes, setNotes] = useState([]);
            const [showAchievementModal, setShowAchievementModal] = useState(null);
            const [showLearnedSongsModal, setShowLearnedSongsModal] = useState(false);
            const [showToLearnSongsModal, setShowToLearnSongsModal] = useState(false);
            const [showNotesModal, setShowNotesModal] = useState(false);

            const categories = {
                techniques: { name: 'Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°', color: 'bg-orange-500', icon: 'âš¡' },
                improvisation: { name: 'Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ', color: 'bg-purple-500', icon: 'ðŸŽ¸' },
                theory: { name: 'Ð¢ÐµÐ¾Ñ€Ð¸Ñ', color: 'bg-green-500', icon: 'ðŸ“š' },
                songs: { name: 'Ð˜Ð³Ñ€Ð° Ð¿ÐµÑÐµÐ½', color: 'bg-pink-500', icon: 'ðŸŽµ' },
                earTraining: { name: 'Ð Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ðµ ÑÐ»ÑƒÑ…Ð°', color: 'bg-blue-500', icon: 'ðŸ‘‚' },
                other: { name: 'ÐŸÑ€Ð¾Ñ‡ÐµÐµ', color: 'bg-teal-500', icon: 'ðŸŽ¼' }
            };

            const subcategories = {
                techniques: ['Ð Ð¸Ñ‚Ð¼Ð¸ÐºÐ° Ð¸ Ð±Ð¾Ð¸', 'ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ ÑˆÑ‚Ñ€Ð¸Ñ…', 'Ð”Ð°ÑƒÐ½ÑÑ‚Ñ€Ð¾Ðº Ð¸ Ð³Ð°Ð»Ð¾Ð¿Ñ‹', 'Ð›ÐµÐ³Ð°Ñ‚Ð¾', 'Ð’Ð¸Ð±Ñ€Ð°Ñ‚Ð¾ Ð¸ Ð±ÐµÐ½Ð´Ñ‹', 'Ð¡Ð²Ð¸Ð¿', 'Ð¤Ð¸Ð½Ð³ÐµÑ€ÑÑ‚Ð°Ð¹Ð»', 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ'],
                improvisation: ['Ð˜Ð³Ñ€Ð° Ð¿Ð¾Ð´ Ð¼Ð¸Ð½ÑƒÑÐ¾Ð²ÐºÐ¸', 'Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð° Ð¿ÐµÑÐ½Ð¸', 'Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð´Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ¾Ð¹'],
                theory: ['Ð˜Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²', 'ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€ÐµÐ½Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°', 'ÐÐ½Ð°Ð»Ð¸Ð· Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ð¸', 'Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð³Ñ€Ð¸Ñ„Ð°'],
                songs: ['Ð Ð°Ð·Ð±Ð¾Ñ€ Ð¿ÐµÑÐ½Ð¸', 'Ð˜Ð³Ñ€Ð° Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¾Ð³Ð¾ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°'],
                earTraining: ['ÐŸÐ¾Ð´Ð±Ð¾Ñ€ Ð½Ð° ÑÐ»ÑƒÑ…', 'ÐŸÐµÐ½Ð¸Ðµ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð¾Ð²', 'ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð°ÐºÐºÐ¾Ñ€Ð´Ð¾Ð²', 'ÐŸÑ€Ð¾Ð¿ÐµÐ» Ð¼ÐµÐ»Ð¾Ð´Ð¸ÑŽ Ð¸ Ð¿Ð¾Ð´Ð¾Ð±Ñ€Ð°Ð» ÐµÐµ Ð½Ð° Ð³Ð¸Ñ‚Ð°Ñ€Ðµ'],
                other: ['ÐÐ°Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿ÐµÑÐµÐ½', 'Ð ÐµÐ¿ÐµÑ‚Ð¸Ñ†Ð¸Ñ Ð² Ð³Ñ€ÑƒÐ¿Ð¿Ðµ', 'Ð—Ð²ÑƒÐºÐ¾Ð·Ð°Ð¿Ð¸ÑÑŒ', 'Ð’Ñ‹ÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ðµ']
            };
            const motivationalQuotes = [
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÑÐ·Ñ‹Ðº Ð´ÑƒÑˆÐ¸, Ð° Ð³Ð¸Ñ‚Ð°Ñ€Ð° - Ñ‚Ð²Ð¾Ð¹ Ð³Ð¾Ð»Ð¾Ñ.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð¼Ð¸Ð½ÑƒÑ‚Ð° Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶Ð°ÐµÑ‚ Ñ‚ÐµÐ±Ñ Ðº Ð¼Ð°ÑÑ‚ÐµÑ€ÑÑ‚Ð²Ñƒ.",
                "Ð’ÐµÐ»Ð¸ÐºÐ¸Ðµ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚Ñ‹ Ð½Ðµ Ñ€Ð¾Ð¶Ð´Ð°ÑŽÑ‚ÑÑ - Ð¾Ð½Ð¸ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒÑŽÑ‚ÑÑ.",
                "Ð¢Ð²Ð¾Ð¸ Ð¿Ð°Ð»ÑŒÑ†Ñ‹ Ð¿Ð¾Ð¼Ð½ÑÑ‚ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ÑÑ ÑÐ½Ð¾Ð²Ð° Ð¸ ÑÐ½Ð¾Ð²Ð°.",
                "ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ - ÑÑ‚Ð¾ ÑÑƒÐ¼Ð¼Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ñ… ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ð¹ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ.",
                "ÐÐµ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð¹ ÑÐµÐ±Ñ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼Ð¸. Ð¡Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð¹ ÑÐµÐ±Ñ Ð²Ñ‡ÐµÑ€Ð°ÑˆÐ½ÐµÐ³Ð¾ Ñ ÑÐ¾Ð±Ð¾Ð¹ ÑÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½Ð¸Ð¼.",
                "Ð¢ÐµÑ€Ð¿ÐµÐ½Ð¸Ðµ Ð¸ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ Ð½Ð¾Ð²Ð¸Ñ‡ÐºÐ° Ð² Ð¼Ð°ÑÑ‚ÐµÑ€Ð°.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ñ‚Ð°Ð¼, Ð³Ð´Ðµ Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÑŽÑ‚ÑÑ ÑÐ»Ð¾Ð²Ð°.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° - ÑÑ‚Ð¾ ÑƒÑ€Ð¾Ðº Ð½Ð° Ð¿ÑƒÑ‚Ð¸ Ðº ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½ÑÑ‚Ð²Ñƒ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ Ñ‚Ð²Ð¾Ð¸Ñ… ÑÐ¼Ð¾Ñ†Ð¸Ð¹.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´ÐµÐ»Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ, Ð° Ð½Ðµ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½ÑÑ‚Ð²Ð¾.",
                "Ð¡ÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½ÑÑ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° - Ð·Ð°Ð²Ñ‚Ñ€Ð°ÑˆÐ½Ð¸Ð¹ ÑƒÑÐ¿ÐµÑ….",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ñ‡ÑƒÐ²ÑÑ‚Ð²ÑƒÑŽÑ‚ Ð¿Ð°Ð»ÑŒÑ†Ñ‹, ÐºÐ¾Ð³Ð´Ð° Ð¼Ð¾Ð»Ñ‡Ð¸Ñ‚ Ñ€Ð°Ð·ÑƒÐ¼.",
                "Ð¢Ñ‹ Ð½Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð±Ð»Ð¸Ð¶Ðµ Ðº ÑÐ²Ð¾ÐµÐ¹ Ñ†ÐµÐ»Ð¸.",
                "Ð¢Ð°Ð»Ð°Ð½Ñ‚ Ð±ÐµÐ· Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - ÐºÐ°Ðº Ð³Ð¸Ñ‚Ð°Ñ€Ð° Ð±ÐµÐ· ÑÑ‚Ñ€ÑƒÐ½.",
                "Ð˜Ð³Ñ€Ð°Ð¹ Ð¾Ñ‚ ÑÐµÑ€Ð´Ñ†Ð°, Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° Ð¿Ñ€Ð¸Ð´Ñ‘Ñ‚ ÑÐ»ÐµÐ´Ð¾Ð¼.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð°ÐºÐºÐ¾Ñ€Ð´ - ÑÑ‚Ð¾ Ð½Ð¾Ð²Ð¾Ðµ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ.",
                "Ð¢Ð²Ð¾Ñ Ð¿Ñ€ÐµÐ´Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐµ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ Ñ‚Ð²Ð¾Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚ÐµÑ€Ð°Ð¿Ð¸Ñ Ð´Ð»Ñ Ð´ÑƒÑˆÐ¸ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚Ð°.",
                "ÐÐµ Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ð¹ÑÑ, ÐºÐ¾Ð³Ð´Ð° ÑƒÑÑ‚Ð°Ð». ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ð¹ÑÑ, ÐºÐ¾Ð³Ð´Ð° Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð».",
                "Ð Ð¸Ñ‚Ð¼ - ÑÑ‚Ð¾ Ð¿ÑƒÐ»ÑŒÑ Ð¼ÑƒÐ·Ñ‹ÐºÐ¸, Ð° Ñ‚Ñ‹ - ÐµÑ‘ ÑÐµÑ€Ð´Ñ†Ðµ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ñ‰Ð°ÐµÑ‚ Ð»ÐµÐ½Ð¸, Ð½Ð¾ Ñ‰ÐµÐ´Ñ€Ð¾ Ð½Ð°Ð³Ñ€Ð°Ð¶Ð´Ð°ÐµÑ‚ ÑƒÑÐµÑ€Ð´Ð¸Ðµ.",
                "Ð¢Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ Ð¸Ð·Ð¼ÐµÑ€ÑÐµÑ‚ÑÑ Ð½Ðµ Ð´Ð½ÑÐ¼Ð¸, Ð° Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¾Ð¹.",
                "Ð’Ð´Ð¾Ñ…Ð½Ð¾Ð²ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚, Ð½Ð¾ Ð¾Ð½Ð¾ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð·Ð°ÑÑ‚Ð°Ñ‚ÑŒ Ñ‚ÐµÐ±Ñ Ð·Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ð¹.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ð¼Ð¾ÑÑ‚ Ð¼ÐµÐ¶Ð´Ñƒ Ð´ÑƒÑˆÐ°Ð¼Ð¸.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð»ÑŽÐ±Ð¾Ð²ÑŒ Ðº Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑƒ, Ð° Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ðº Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñƒ.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð²ÐµÐ»Ð¸ÐºÐ¸Ð¹ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚ Ð±Ñ‹Ð» ÐºÐ¾Ð³Ð´Ð°-Ñ‚Ð¾ Ð½Ð¾Ð²Ð¸Ñ‡ÐºÐ¾Ð¼.",
                "Ð¢Ð²Ð¾Ð¸ Ñ€ÑƒÐºÐ¸ - Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚, Ñ‚Ð²Ð¾Ñ‘ ÑÐµÑ€Ð´Ñ†Ðµ - Ð¼ÑƒÐ·Ñ‹ÐºÐ°.",
                "ÐÐµ Ð±Ð¾Ð¹ÑÑ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾Ð¹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - Ð±Ð¾Ð¹ÑÑ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° Ð¶Ð´Ñ‘Ñ‚ Ñ‚Ð²Ð¾Ð¸Ñ… Ñ€ÑƒÐº ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ, ÐºÐ¾Ð³Ð´Ð° Ð·Ð°Ð±Ñ‹Ð²Ð°ÐµÑˆÑŒ ÑÐ»Ð¾Ð²Ð°.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ð¼ÐµÐ¶Ð´Ñƒ Ñ‚Ð¾Ð±Ð¾Ð¹ Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð¼.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð±ÐµÐ½Ð´, ÐºÐ°Ð¶Ð´Ð¾Ðµ Ð²Ð¸Ð±Ñ€Ð°Ñ‚Ð¾ - ÑÑ‚Ð¾ Ñ‚Ð²Ð¾Ñ Ð¿Ð¾Ð´Ð¿Ð¸ÑÑŒ.",
                "Ð¢Ñ‹ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¸Ð³Ñ€Ð°ÐµÑˆÑŒ Ð½Ð¾Ñ‚Ñ‹ - Ñ‚Ñ‹ Ñ€Ð°ÑÑÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑˆÑŒ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ.",
                "Ð¢ÐµÑ€Ð¿ÐµÐ½Ð¸Ðµ - Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ ÑƒÑ‡Ð¸Ñ‚ÐµÐ»ÑŒ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚Ð°.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ¾Ð³Ð´Ð° Ð³Ð¸Ñ‚Ð°Ñ€Ð° Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐºÐ°Ð·Ð°Ñ‚ÑŒ.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ñ‚Ð°Ðº, Ð±ÑƒÐ´Ñ‚Ð¾ Ð½Ð¸ÐºÑ‚Ð¾ Ð½Ðµ ÑÐ»ÑƒÑˆÐ°ÐµÑ‚. Ð˜Ð³Ñ€Ð°Ð¹ Ñ‚Ð°Ðº, Ð±ÑƒÐ´Ñ‚Ð¾ Ð²ÑÐµ ÑÐ»ÑƒÑˆÐ°ÑŽÑ‚.",
                "Ð¢Ð²Ð¾Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð»ÐµÑÑ‚Ð½Ð¸Ñ†Ð° Ðº ÑÐ²Ð¾Ð±Ð¾Ð´Ðµ Ð¸Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ð¸.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ ÑÐµÑ€Ð¸Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶Ð°ÐµÑ‚ Ñ‚ÐµÐ±Ñ Ðº Ð¿Ð¾Ñ‚Ð¾ÐºÑƒ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ð·ÐµÑ€ÐºÐ°Ð»Ð¾ Ñ‚Ð²Ð¾ÐµÐ¹ Ð´ÑƒÑˆÐ¸.",
                "ÐÐµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ Ð´Ð¾ Ñ‚ÐµÑ… Ð¿Ð¾Ñ€, Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÑ‹Ð³Ñ€Ð°ÐµÑˆÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾. ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ Ð´Ð¾ Ñ‚ÐµÑ… Ð¿Ð¾Ñ€, Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÐ¼Ð¾Ð¶ÐµÑˆÑŒ ÑÑ‹Ð³Ñ€Ð°Ñ‚ÑŒ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÑÐ¼Ð¾Ñ†Ð¸Ð¸ Ð² Ñ„Ð¾Ñ€Ð¼Ðµ Ð·Ð²ÑƒÐºÐ¾Ð².",
                "Ð¢Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼, Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¾Ð³Ð»ÑÐ½ÐµÑˆÑŒÑÑ Ð½Ð°Ð·Ð°Ð´.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ñ Ð² Ð±ÑƒÐ´ÑƒÑ‰ÐµÐµ Ð¼Ð°ÑÑ‚ÐµÑ€ÑÑ‚Ð²Ð¾.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° ÑƒÑ‡Ð¸Ñ‚ Ñ‚ÐµÐ±Ñ Ð±Ñ‹Ñ‚ÑŒ Ñ‚ÐµÑ€Ð¿ÐµÐ»Ð¸Ð²Ñ‹Ð¼ Ð¸ Ð½Ð°ÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ñ‹Ð¼.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐµÐ´Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ·Ñ‹Ðº, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÑŽÑ‚ Ð²ÑÐµ.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð¼ÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚Ð°.",
                "Ð¢Ñ‹ Ñ€Ð°ÑÑ‚Ñ‘ÑˆÑŒ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð°Ð·, ÐºÐ¾Ð³Ð´Ð° Ð±ÐµÑ€Ñ‘ÑˆÑŒ Ð³Ð¸Ñ‚Ð°Ñ€Ñƒ Ð² Ñ€ÑƒÐºÐ¸.",
                "ÐÐµ Ð¸Ñ‰Ð¸ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½ÑÑ‚Ð²Ð° - Ð¸Ñ‰Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ Ð¶Ð¸Ð·Ð½ÑŒ Ð¾ÑÐ¼Ñ‹ÑÐ»ÐµÐ½Ð½Ð¾Ð¹.",
                "Ð¢Ð²Ð¾Ñ Ð¿Ñ€ÐµÐ´Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð¸Ñ‚Ð°Ñ€Ðµ Ð²ÐµÑ€Ð½Ñ‘Ñ‚ÑÑ Ðº Ñ‚ÐµÐ±Ðµ ÑÑ‚Ð¾Ñ€Ð¸Ñ†ÐµÐ¹.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð¸Ñ„, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ñ‚Ñ‹ Ð²Ñ‹ÑƒÑ‡Ð¸ÑˆÑŒ, Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÐµÑ‚ Ñ‚Ð²Ð¾Ð¹ ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð¿ÑƒÑ‚ÑŒ, Ð° Ð½Ðµ Ð¿ÑƒÐ½ÐºÑ‚ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ñ‚Ð°Ð»Ð°Ð½Ñ‚Ð° - Ð¾Ð½Ð° Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð»ÑŽÐ±Ð²Ð¸.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ¾Ð³Ð´Ð° Ð²Ñ€ÐµÐ¼Ñ Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ.",
                "Ð¢Ð²Ð¾Ð¸ Ð¿Ð°Ð»ÑŒÑ†Ñ‹ - ÑÑ‚Ð¾ ÐºÐ¸ÑÑ‚Ð¸, Ð³Ñ€Ð¸Ñ„ - Ñ…Ð¾Ð»ÑÑ‚.",
                "ÐÐµ Ð±Ð¾Ð¹ÑÑ Ð¾ÑˆÐ¸Ð±Ð¾Ðº - Ð¾Ð½Ð¸ Ñ‡Ð°ÑÑ‚ÑŒ Ð¿ÑƒÑ‚Ð¸.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð±ÐµÐ· Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - ÑˆÐ°Ð³ Ð½Ð°Ð·Ð°Ð´.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ð¿Ð¸Ñ‰Ð° Ð´Ð»Ñ Ð´ÑƒÑˆÐ¸ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚Ð°.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ñ ÑƒÐ¼Ð¾Ð¼, Ð¸Ð³Ñ€Ð°Ð¹ Ñ ÑÐµÑ€Ð´Ñ†ÐµÐ¼.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ð´Ñ€ÑƒÐ³, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð²ÑÐµÐ³Ð´Ð° Ñ€ÑÐ´Ð¾Ð¼.",
                "Ð¢Ð²Ð¾Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚ Ñ‚Ð²Ð¾ÐµÐ¹ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸.",
                "ÐÐµ ÑÑ‡Ð¸Ñ‚Ð°Ð¹ Ñ‡Ð°ÑÑ‹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - Ð´ÐµÐ»Ð°Ð¹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒ Ð²Ð°Ð¶Ð½Ð¾Ð¹.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ ÑÐ¾ÐµÐ´Ð¸Ð½ÑÐµÑ‚ Ð½Ð°Ñ Ð²ÑÐµÑ….",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð½Ð¾Ñ‚Ð° - ÑÑ‚Ð¾ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ñ‹Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ ÑÐµÐ±Ñ.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ»ÑŽÑ‡ Ðº Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ²Ð¾Ð±Ð¾Ð´Ðµ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° Ð½Ð°ÑƒÑ‡Ð¸Ñ‚ Ñ‚ÐµÐ±Ñ Ð´Ð¸ÑÑ†Ð¸Ð¿Ð»Ð¸Ð½Ðµ Ð¸ ÑÑ‚Ñ€Ð°ÑÑ‚Ð¸.",
                "Ð¢Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ - ÑÑ‚Ð¾ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ñ‚Ð²Ð¾ÐµÐ¹ Ð¿Ñ€ÐµÐ´Ð°Ð½Ð½Ð¾ÑÑ‚Ð¸.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ¾Ð³Ð´Ð° Ð´ÑƒÑˆÐ° Ð¿Ð¾Ñ‘Ñ‚ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð°Ð»ÑŒÑ†Ñ‹.",
                "ÐÐµ Ð¶Ð´Ð¸ Ð¼Ð¾Ñ‚Ð¸Ð²Ð°Ñ†Ð¸Ð¸ - ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ð¹ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´ÐµÐ»Ð°ÐµÑ‚ Ñ‚ÐµÐ±Ñ Ð»ÑƒÑ‡ÑˆÐµÐ¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ ÑÐµÐ±Ñ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ ÑÐ°Ð¼Ð¾Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð°Ñ Ð¸ÑÑ‚Ð¸Ð½Ð°.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ, ÐºÐ¾Ð³Ð´Ð° Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²Ð»Ñ‘Ð½. ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ, ÐºÐ¾Ð³Ð´Ð° Ð½ÐµÑ‚.",
                "Ð¢Ð²Ð¾Ð¸ Ñ€ÑƒÐºÐ¸ Ð¿Ð¾Ð¼Ð½ÑÑ‚ Ð±Ð¾Ð»ÑŒÑˆÐµ, Ñ‡ÐµÐ¼ Ñ‚Ñ‹ Ð´ÑƒÐ¼Ð°ÐµÑˆÑŒ.",
                "ÐÐµ ÑÐ´Ð°Ð²Ð°Ð¹ÑÑ - ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¼Ð°ÑÑ‚ÐµÑ€ Ð±Ñ‹Ð» ÐºÐ¾Ð³Ð´Ð°-Ñ‚Ð¾ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ¾Ð¼.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ð¼Ð°Ð³Ð¸Ñ Ð² Ñ„Ð¾Ñ€Ð¼Ðµ Ð·Ð²ÑƒÐºÐ¾Ð².",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÑÐ»Ð¾Ð¶Ð½Ð¾Ðµ Ð² Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ðµ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ð¾ÐºÐ½Ð¾ Ð² Ñ‚Ð²Ð¾ÑŽ Ð´ÑƒÑˆÑƒ.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð³Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚ ÑƒÐ½Ð¸ÐºÐ°Ð»ÐµÐ½ - Ð½Ð°Ð¹Ð´Ð¸ ÑÐ²Ð¾Ð¹ Ð³Ð¾Ð»Ð¾Ñ.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€ Ñ ÑÐ°Ð¼Ð¸Ð¼ ÑÐ¾Ð±Ð¾Ð¹.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° Ð¶Ð´Ñ‘Ñ‚, ÐºÐ¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð²ÐµÑ€Ð½Ñ‘ÑˆÑŒÑÑ Ðº Ð½ÐµÐ¹.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ¾Ð³Ð´Ð° Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°ÐµÑ‚ÑÑ Ñ ÑÐ¼Ð¾Ñ†Ð¸ÐµÐ¹.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ Ð¼Ð¸Ð½ÑƒÑ‚Ð° Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - ÑÑ‚Ð¾ Ð¿Ð¾Ð´Ð°Ñ€Ð¾Ðº Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ¼Ñƒ ÑÐµÐ±Ðµ.",
                "Ð¢Ð²Ð¾Ñ Ð¼ÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ð¾Ñ‚Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ñ‚Ð²Ð¾ÐµÐ¹ Ð´ÑƒÑˆÐ¸.",
                "ÐÐµ Ð±Ð¾Ð¹ÑÑ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒ Ð·Ð°Ð½Ð¾Ð²Ð¾ - ÑÑ‚Ð¾ Ñ‡Ð°ÑÑ‚ÑŒ Ñ€Ð¾ÑÑ‚Ð°.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ðµ Ð´Ð»Ð¸Ð½Ð¾ÑŽ Ð² Ð¶Ð¸Ð·Ð½ÑŒ.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° ÑƒÑ‡Ð¸Ñ‚ Ñ‚ÐµÐ±Ñ ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ Ð¸ Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÑÐ·Ñ‹Ðº, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð½Ðµ Ð½ÑƒÐ¶Ð´Ð°ÐµÑ‚ÑÑ Ð² Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ðµ.",
                "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ - ÑÑ‚Ð¾ Ð¿Ð¾Ð±ÐµÐ´Ð°.",
                "Ð¢Ð²Ð¾Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° ÑÐ»ÑƒÐ¶Ð¸Ñ‚ Ñ‚Ð²Ð¾ÐµÐ¹ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸.",
                "ÐÐµ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð¹ ÑÐ²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¾Ð¼ Ð´Ñ€ÑƒÐ³Ð¸Ñ….",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ ÐºÐ¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð·Ð°Ð±Ñ‹Ð²Ð°ÐµÑˆÑŒ Ð¾Ð±Ð¾ Ð²ÑÑ‘Ð¼.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° - ÑÑ‚Ð¾ Ð»ÑŽÐ±Ð¾Ð²ÑŒ Ð² Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¸.",
                "Ð“Ð¸Ñ‚Ð°Ñ€Ð° - ÑÑ‚Ð¾ Ñ‚Ð²Ð¾Ð¹ Ð³Ð¾Ð»Ð¾Ñ, ÐºÐ¾Ð³Ð´Ð° ÑÐ»Ð¾Ð²Ð° Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹.",
                "ÐšÐ°Ð¶Ð´Ð°Ñ ÑÐµÑ€Ð¸Ñ Ð´ÐµÐ»Ð°ÐµÑ‚ Ñ‚ÐµÐ±Ñ ÑÐ¸Ð»ÑŒÐ½ÐµÐµ.",
                "ÐœÑƒÐ·Ñ‹ÐºÐ° - ÑÑ‚Ð¾ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ Ð²ÐµÑ‡Ð½Ñ‹Ð¼.",
                "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ñ Ñ†ÐµÐ»ÑŒÑŽ, Ð¸Ð³Ñ€Ð°Ð¹ Ñ Ñ€Ð°Ð´Ð¾ÑÑ‚ÑŒÑŽ."
            ];

            // Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹
            const levelTable = [
                { level: 1, totalXP: 0, nextLevelXP: 100, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 2, totalXP: 100, nextLevelXP: 150, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 3, totalXP: 250, nextLevelXP: 200, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 4, totalXP: 450, nextLevelXP: 250, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 5, totalXP: 700, nextLevelXP: 300, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 6, totalXP: 1000, nextLevelXP: 350, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 7, totalXP: 1350, nextLevelXP: 400, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 8, totalXP: 1750, nextLevelXP: 450, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 9, totalXP: 2200, nextLevelXP: 500, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 10, totalXP: 2700, nextLevelXP: 550, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 11, totalXP: 3250, nextLevelXP: 600, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 12, totalXP: 3850, nextLevelXP: 650, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 13, totalXP: 4500, nextLevelXP: 700, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 14, totalXP: 5200, nextLevelXP: 750, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 15, totalXP: 5950, nextLevelXP: 800, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 16, totalXP: 6750, nextLevelXP: 850, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 17, totalXP: 7600, nextLevelXP: 900, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 18, totalXP: 8500, nextLevelXP: 950, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 19, totalXP: 9450, nextLevelXP: 1000, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 20, totalXP: 10450, nextLevelXP: 1200, rank: 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº' },
                { level: 21, totalXP: 11650, nextLevelXP: 1400, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 22, totalXP: 13050, nextLevelXP: 1400, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 23, totalXP: 14450, nextLevelXP: 1400, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 24, totalXP: 15850, nextLevelXP: 1400, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 25, totalXP: 17250, nextLevelXP: 1400, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 26, totalXP: 18650, nextLevelXP: 1600, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 27, totalXP: 20250, nextLevelXP: 1600, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 28, totalXP: 21850, nextLevelXP: 1600, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 29, totalXP: 23450, nextLevelXP: 1600, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 30, totalXP: 25050, nextLevelXP: 1600, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 31, totalXP: 26650, nextLevelXP: 1800, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 32, totalXP: 28450, nextLevelXP: 1800, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 33, totalXP: 30250, nextLevelXP: 1800, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 34, totalXP: 32050, nextLevelXP: 1800, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 35, totalXP: 33850, nextLevelXP: 1800, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 36, totalXP: 35650, nextLevelXP: 2200, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 37, totalXP: 37850, nextLevelXP: 2200, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 38, totalXP: 40050, nextLevelXP: 2200, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 39, totalXP: 42250, nextLevelXP: 2200, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 40, totalXP: 44450, nextLevelXP: 2200, rank: 'Ð£Ñ‡ÐµÐ½Ð¸Ðº' },
                { level: 41, totalXP: 46650, nextLevelXP: 2500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 42, totalXP: 49150, nextLevelXP: 2500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 43, totalXP: 51650, nextLevelXP: 2500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 44, totalXP: 54150, nextLevelXP: 2500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 45, totalXP: 56650, nextLevelXP: 3000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 46, totalXP: 59650, nextLevelXP: 3000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 47, totalXP: 62650, nextLevelXP: 3000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 48, totalXP: 65650, nextLevelXP: 3000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 49, totalXP: 68650, nextLevelXP: 3000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 50, totalXP: 71650, nextLevelXP: 3500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 51, totalXP: 75150, nextLevelXP: 3500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 52, totalXP: 78650, nextLevelXP: 3500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 53, totalXP: 82150, nextLevelXP: 3500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 54, totalXP: 85650, nextLevelXP: 3500, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 55, totalXP: 89150, nextLevelXP: 4000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 56, totalXP: 93150, nextLevelXP: 4000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 57, totalXP: 97150, nextLevelXP: 4000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 58, totalXP: 101150, nextLevelXP: 4000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 59, totalXP: 105150, nextLevelXP: 4000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 60, totalXP: 109150, nextLevelXP: 5000, rank: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸Ðº' },
                { level: 61, totalXP: 114150, nextLevelXP: 6000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 62, totalXP: 120150, nextLevelXP: 6000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 63, totalXP: 126150, nextLevelXP: 6000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 64, totalXP: 132150, nextLevelXP: 6000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 65, totalXP: 138150, nextLevelXP: 7000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 66, totalXP: 145150, nextLevelXP: 7000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 67, totalXP: 152150, nextLevelXP: 7000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 68, totalXP: 159150, nextLevelXP: 7000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 69, totalXP: 166150, nextLevelXP: 7000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 70, totalXP: 173150, nextLevelXP: 8000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 71, totalXP: 181150, nextLevelXP: 8000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 72, totalXP: 189150, nextLevelXP: 8000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 73, totalXP: 197150, nextLevelXP: 8000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 74, totalXP: 205150, nextLevelXP: 8000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 75, totalXP: 213150, nextLevelXP: 10000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 76, totalXP: 223150, nextLevelXP: 10000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 77, totalXP: 233150, nextLevelXP: 10000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 78, totalXP: 243150, nextLevelXP: 10000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 79, totalXP: 253150, nextLevelXP: 10000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 80, totalXP: 263150, nextLevelXP: 12000, rank: 'Ð’Ð¸Ñ€Ñ‚ÑƒÐ¾Ð·' },
                { level: 81, totalXP: 275150, nextLevelXP: 15000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 82, totalXP: 290150, nextLevelXP: 15000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 83, totalXP: 305150, nextLevelXP: 15000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 84, totalXP: 320150, nextLevelXP: 15000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 85, totalXP: 335150, nextLevelXP: 18000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 86, totalXP: 353150, nextLevelXP: 18000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 87, totalXP: 371150, nextLevelXP: 18000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 88, totalXP: 389150, nextLevelXP: 18000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 89, totalXP: 407150, nextLevelXP: 18000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 90, totalXP: 425150, nextLevelXP: 22000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 91, totalXP: 447150, nextLevelXP: 22000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 92, totalXP: 469150, nextLevelXP: 22000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 93, totalXP: 491150, nextLevelXP: 22000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 94, totalXP: 513150, nextLevelXP: 22000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 95, totalXP: 535150, nextLevelXP: 27000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 96, totalXP: 562150, nextLevelXP: 27000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 97, totalXP: 589150, nextLevelXP: 27000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 98, totalXP: 616150, nextLevelXP: 27000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 99, totalXP: 643150, nextLevelXP: 27000, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾' },
                { level: 100, totalXP: 670150, nextLevelXP: 0, rank: 'ÐœÐ°ÑÑÑ‚Ñ€Ð¾ (Ð›ÐµÐ³ÐµÐ½Ð´Ð°)' }
            ];

            useEffect(() => {
                const loadData = async () => {
                    const telegramUser = tg.initDataUnsafe?.user;
                    if (telegramUser) setUserProfile(prev => ({ ...prev, username: telegramUser.username || telegramUser.first_name || 'Ð“Ð¸Ñ‚Ð°Ñ€Ð¸ÑÑ‚', avatar: telegramUser.photo_url || '' }));
                    
                    if (tg.CloudStorage) {
                        tg.CloudStorage.getItems(['practiceData', 'learnedSongs', 'toLearnSongs', 'darkTheme', 'userProfile', 'friends', 'friendRequests', 'notes'], (error, result) => {
                            if (!error && result) {
                                if (result.practiceData) setPracticeData(JSON.parse(result.practiceData));
                                if (result.learnedSongs) setLearnedSongs(JSON.parse(result.learnedSongs));
                                if (result.toLearnSongs) setToLearnSongs(JSON.parse(result.toLearnSongs));
                                if (result.darkTheme) setDarkTheme(JSON.parse(result.darkTheme));
                                if (result.userProfile) setUserProfile(prev => ({ ...prev, ...JSON.parse(result.userProfile), lastLogin: new Date().toISOString() }));
                                if (result.friends) setFriends(JSON.parse(result.friends));
                                if (result.friendRequests) setFriendRequests(JSON.parse(result.friendRequests));
                                if (result.notes) setNotes(JSON.parse(result.notes));
                            }
                            setLoading(false);
                        });
                    } else {
                        ['practiceData', 'learnedSongs', 'toLearnSongs', 'darkTheme', 'userProfile', 'friends', 'notes'].forEach(key => {
                            const data = localStorage.getItem(key);
                            if (data) {
                                if (key === 'practiceData') setPracticeData(JSON.parse(data));
                                else if (key === 'learnedSongs') setLearnedSongs(JSON.parse(data));
                                else if (key === 'toLearnSongs') setToLearnSongs(JSON.parse(data));
                                else if (key === 'darkTheme') setDarkTheme(JSON.parse(data));
                                else if (key === 'userProfile') setUserProfile(JSON.parse(data));
                                else if (key === 'friends') setFriends(JSON.parse(data));
                                else if (key === 'notes') setNotes(JSON.parse(data));
                            }
                        });
                        setLoading(false);
                    }
                };
                loadData();
                setDailyQuote(motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)]);
            }, []);

            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('practiceData', JSON.stringify(practiceData)); else localStorage.setItem('practiceData', JSON.stringify(practiceData)); } }, [practiceData, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('darkTheme', JSON.stringify(darkTheme)); else localStorage.setItem('darkTheme', JSON.stringify(darkTheme)); if (darkTheme) document.body.classList.add('dark-theme'); else document.body.classList.remove('dark-theme'); } }, [darkTheme, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('learnedSongs', JSON.stringify(learnedSongs)); else localStorage.setItem('learnedSongs', JSON.stringify(learnedSongs)); } }, [learnedSongs, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('toLearnSongs', JSON.stringify(toLearnSongs)); else localStorage.setItem('toLearnSongs', JSON.stringify(toLearnSongs)); } }, [toLearnSongs, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('userProfile', JSON.stringify(userProfile)); else localStorage.setItem('userProfile', JSON.stringify(userProfile)); } }, [userProfile, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('friends', JSON.stringify(friends)); else localStorage.setItem('friends', JSON.stringify(friends)); } }, [friends, loading]);
            useEffect(() => { if (!loading) { if (tg.CloudStorage) tg.CloudStorage.setItem('notes', JSON.stringify(notes)); else localStorage.setItem('notes', JSON.stringify(notes)); } }, [notes, loading]);

            const formatDateKey = (date) => `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            const getDaysInMonth = (date) => { const year = date.getFullYear(), month = date.getMonth(); const dayOfWeek = new Date(year, month, 1).getDay(); return { daysInMonth: new Date(year, month + 1, 0).getDate(), startingDayOfWeek: (dayOfWeek + 6) % 7 }; };
            const getTotalMinutes = (dateKey) => practiceData[dateKey]?.entries?.reduce((sum, e) => sum + (e.minutes || 0), 0) || 0;
            const calculateStreak = () => { 
                const today = new Date(); 
                today.setHours(0, 0, 0, 0); 
                let streak = 0;
                let currentDate = new Date(today);
                
                // Ð•ÑÐ»Ð¸ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ°, ÑÑ‡Ð¸Ñ‚Ð°ÐµÐ¼ Ñ ÑÐµÐ³Ð¾Ð´Ð½Ñ
                if (getTotalMinutes(formatDateKey(currentDate)) > 0) {
                    while (getTotalMinutes(formatDateKey(currentDate)) > 0) { 
                        streak++; 
                        currentDate.setDate(currentDate.getDate() - 1); 
                    }
                } else {
                    // Ð•ÑÐ»Ð¸ ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð½ÐµÑ‚ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²Ñ‡ÐµÑ€Ð°
                    currentDate.setDate(currentDate.getDate() - 1);
                    while (getTotalMinutes(formatDateKey(currentDate)) > 0) { 
                        streak++; 
                        currentDate.setDate(currentDate.getDate() - 1); 
                    }
                }
                
                return streak; 
            };
            
            const calculateMaxStreak = () => {
                const allDates = Object.keys(practiceData).sort();
                if (allDates.length === 0) return 0;
                
                let maxStreak = 0;
                let currentStreak = 0;
                let prevDate = null;
                
                allDates.forEach(dateKey => {
                    if (getTotalMinutes(dateKey) > 0) {
                        if (prevDate === null) {
                            currentStreak = 1;
                        } else {
                            const prev = new Date(prevDate);
                            const curr = new Date(dateKey);
                            const diffDays = Math.floor((curr - prev) / (1000 * 60 * 60 * 24));
                            
                            if (diffDays === 1) {
                                currentStreak++;
                            } else {
                                maxStreak = Math.max(maxStreak, currentStreak);
                                currentStreak = 1;
                            }
                        }
                        prevDate = dateKey;
                    }
                });
                
                return Math.max(maxStreak, currentStreak);
            };
            const getTotalPracticeMinutes = () => Object.keys(practiceData).reduce((sum, key) => sum + getTotalMinutes(key), 0);
            const getMinutesThisWeek = () => { const today = new Date(), start = new Date(today); start.setDate(today.getDate() - today.getDay()); start.setHours(0, 0, 0, 0); let total = 0; for (let d = new Date(start); d <= today; d.setDate(d.getDate() + 1)) total += getTotalMinutes(formatDateKey(d)); return total; };
            const getMinutesThisMonth = () => { const today = new Date(), start = new Date(today.getFullYear(), today.getMonth(), 1); let total = 0; for (let d = new Date(start); d <= today; d.setDate(d.getDate() + 1)) total += getTotalMinutes(formatDateKey(d)); return total; };
            const getCategoryMinutes = (cat) => Object.values(practiceData).reduce((sum, day) => sum + (day.entries?.filter(e => e.category === cat).reduce((s, e) => s + (e.minutes || 0), 0) || 0), 0);
            const getTechniqueMinutes = (tech) => Object.values(practiceData).reduce((sum, day) => sum + (day.entries?.filter(e => e.category === 'techniques' && e.selectedTechniques?.includes(tech)).reduce((s, e) => s + (e.minutes || 0), 0) || 0), 0);
            const getTop3Techniques = () => subcategories.techniques.map(t => ({ name: t, minutes: getTechniqueMinutes(t) })).filter(t => t.minutes > 0).sort((a, b) => b.minutes - a.minutes).slice(0, 3);
            const getSortedCategories = () => Object.entries(categories).map(([key, cat]) => ({ key, ...cat, minutes: getCategoryMinutes(key) })).sort((a, b) => b.minutes - a.minutes);
            
            // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹
            const getExperience = () => {
                const practiceXP = getTotalPracticeMinutes(); // 1 Ð¼Ð¸Ð½ÑƒÑ‚Ð° = 1 XP
                
                // ÐŸÐ¾Ð´ÑÑ‡ÐµÑ‚ XP Ð¾Ñ‚ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¹ (Ð¸ÑÐºÐ»ÑŽÑ‡Ð°Ñ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð·Ð° ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð±Ñ‹Ð»Ð¾ Ñ†Ð¸ÐºÐ»Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸)
                const streak = calculateStreak();
                let achievementXP = 0;
                
                achievements.forEach(a => {
                    // ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð·Ð° ÑƒÑ€Ð¾Ð²Ð½Ð¸
                    if (a.id.startsWith('level_')) return;
                    
                    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ
                    const isUnlocked = a.checkFunc 
                        ? a.checkFunc() 
                        : a.type === 'streak' 
                            ? streak >= a.threshold 
                            : a.technique 
                                ? getTechniqueMinutes(a.technique) >= a.threshold 
                                : getCategoryMinutes(a.type) >= a.threshold;
                    
                    if (isUnlocked) {
                        achievementXP += (a.xp || 0);
                    }
                });
                
                return practiceXP + achievementXP;
            };
            
            const getLevelInfo = () => {
                const totalXP = getExperience();
                let currentLevel = 1;
                let currentXP = totalXP;
                
                for (let i = 0; i < levelTable.length; i++) {
                    if (totalXP >= levelTable[i].totalXP) {
                        currentLevel = levelTable[i].level;
                        currentXP = totalXP - levelTable[i].totalXP;
                    } else {
                        break;
                    }
                }
                
                const levelData = levelTable.find(l => l.level === currentLevel);
                const nextLevelXP = levelData ? levelData.nextLevelXP : 0;
                const rank = levelData ? levelData.rank : 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº';
                const progress = nextLevelXP > 0 ? (currentXP / nextLevelXP) * 100 : 100;
                
                return {
                    level: currentLevel,
                    rank: rank,
                    currentXP: currentXP,
                    nextLevelXP: nextLevelXP,
                    totalXP: totalXP,
                    progress: Math.min(progress, 100)
                };
            };
            
            const checkTimeBasedAchievement = (startHour, endHour) => Object.keys(practiceData).some(k => practiceData[k].entries?.some(e => { const h = new Date(e.timestamp).getHours(); return startHour < endHour ? (h >= startHour && h < endHour) : (h >= startHour || h < endHour); }));
            const checkMarathonDay = (mins) => Object.keys(practiceData).some(k => getTotalMinutes(k) >= mins);
            const checkWeeklyMarathon = () => { const today = new Date(); for (let w = 0; w < 52; w++) { let valid = true; for (let d = 0; d < 7; d++) { const date = new Date(today); date.setDate(today.getDate() - w * 7 - d); if (getTotalMinutes(formatDateKey(date)) < 120) { valid = false; break; } } if (valid) return true; } return false; };
            const check14DaysMarathon = () => { const today = new Date(); for (let w = 0; w < 52; w++) { let valid = true; for (let d = 0; d < 14; d++) { const date = new Date(today); date.setDate(today.getDate() - w * 14 - d); if (getTotalMinutes(formatDateKey(date)) < 120) { valid = false; break; } } if (valid) return true; } return false; };
            const check28DaysMarathon = () => { const today = new Date(); for (let w = 0; w < 52; w++) { let valid = true; for (let d = 0; d < 28; d++) { const date = new Date(today); date.setDate(today.getDate() - w * 28 - d); if (getTotalMinutes(formatDateKey(date)) < 120) { valid = false; break; } } if (valid) return true; } return false; };
            const checkFullCycle = () => Object.keys(practiceData).some(k => new Set(practiceData[k].entries?.map(e => e.category)).size === 6);
            const checkAllTechniquesWeek = () => { const today = new Date(), used = new Set(); for (let d = 0; d < 7; d++) { const date = new Date(today); date.setDate(today.getDate() - d); practiceData[formatDateKey(date)]?.entries?.forEach(e => e.selectedTechniques?.forEach(t => used.add(t))); } return used.size === subcategories.techniques.length; };

            const achievements = [
                { id: 'streak_10', name: '10 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´', icon: 'ðŸ”¥', type: 'streak', threshold: 10, xp: 50, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 10 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ð°' },
                { id: 'streak_30', name: '30 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´', icon: 'âš¡', type: 'streak', threshold: 30, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 30 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ð°' },
                { id: 'streak_100', name: '100 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´', icon: 'ðŸ’Ž', type: 'streak', threshold: 100, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 100 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ð°' },
                { id: 'streak_365', name: 'Ð“Ð¾Ð´ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸', icon: 'ðŸ‘‘', type: 'streak', threshold: 365, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 365 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ð°' },
                { id: 'night_owl', name: 'ÐÐ¾Ñ‡Ð½Ð°Ñ ÑÐ¾Ð²Ð°', icon: 'ðŸ¦‰', checkFunc: () => checkTimeBasedAchievement(22, 4), xp: 20, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð· Ð¼ÐµÐ¶Ð´Ñƒ 22:00 Ð¸ 04:00' },
                { id: 'early_bird', name: 'Ð–Ð°Ð²Ð¾Ñ€Ð¾Ð½Ð¾Ðº', icon: 'ðŸ¦', checkFunc: () => checkTimeBasedAchievement(6, 9), xp: 20, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð· Ð¼ÐµÐ¶Ð´Ñƒ 6:00 Ð¸ 9:00' },
                { id: 'marathon_2h', name: 'ÐœÐ°Ñ€Ð°Ñ„Ð¾Ð½ÐµÑ† 2Ñ‡', icon: 'ðŸƒ', checkFunc: () => checkMarathonDay(120), xp: 50, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 2 Ñ‡Ð°ÑÐ° (120 Ð¼Ð¸Ð½ÑƒÑ‚) Ð·Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ' },
                { id: 'marathon_3h', name: 'ÐœÐ°Ñ€Ð°Ñ„Ð¾Ð½ÐµÑ† 3Ñ‡', icon: 'ðŸƒâ€â™‚ï¸', checkFunc: () => checkMarathonDay(180), xp: 50, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 3 Ñ‡Ð°ÑÐ° (180 Ð¼Ð¸Ð½ÑƒÑ‚) Ð·Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ' },
                { id: 'marathon_4h', name: 'ÐœÐ°Ñ€Ð°Ñ„Ð¾Ð½ÐµÑ† 4Ñ‡', icon: 'ðŸƒâ€â™€ï¸', checkFunc: () => checkMarathonDay(240), xp: 50, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ 4 Ñ‡Ð°ÑÐ° (240 Ð¼Ð¸Ð½ÑƒÑ‚) Ð·Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ' },
                { id: 'weekly_marathon', name: 'Ð¢ÐµÑ€Ð¿ÐµÐ½Ð¸Ðµ Ð¸ Ñ‚Ñ€ÑƒÐ´ (7Ð´)', icon: 'ðŸ’ª', checkFunc: checkWeeklyMarathon, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 Ñ‡Ð°ÑÐ° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´' },
                { id: '14days_marathon', name: 'Ð¢ÐµÑ€Ð¿ÐµÐ½Ð¸Ðµ Ð¸ Ñ‚Ñ€ÑƒÐ´ (14Ð´)', icon: 'ðŸ’ª', checkFunc: check14DaysMarathon, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 Ñ‡Ð°ÑÐ° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ 14 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´' },
                { id: '28days_marathon', name: 'Ð¢ÐµÑ€Ð¿ÐµÐ½Ð¸Ðµ Ð¸ Ñ‚Ñ€ÑƒÐ´ (28Ð´)', icon: 'ðŸ’ª', checkFunc: check28DaysMarathon, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 Ñ‡Ð°ÑÐ° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ 28 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´' },
                { id: 'full_cycle', name: 'ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ»', icon: 'ðŸ”„', checkFunc: checkFullCycle, xp: 50, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ÑÑ Ð¿Ð¾ Ð²ÑÐµÐ¼ 6 ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ð·Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ' },
                { id: 'perfectionist', name: 'ÐŸÐµÑ€Ñ„ÐµÐºÑ†Ð¸Ð¾Ð½Ð¸ÑÑ‚', icon: 'âœ¨', checkFunc: checkAllTechniquesWeek, xp: 100, desc: 'ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐ¹ Ð²ÑÐµ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ¸ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ð¸' },
                { id: 'technique_1h', name: 'Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°: 1 Ñ‡Ð°Ñ', icon: 'âš¡', type: 'techniques', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°' },
                { id: 'technique_10h', name: 'Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŽ¸', type: 'techniques', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°' },
                { id: 'technique_100h', name: 'Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°: 100 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸ”¥', type: 'techniques', threshold: 6000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 100 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¢ÐµÑ…Ð½Ð¸ÐºÐ°' },
                { id: 'improv_1h', name: 'Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ: 1 Ñ‡Ð°Ñ', icon: 'ðŸŽµ', type: 'improvisation', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ' },
                { id: 'improv_10h', name: 'Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŽ¼', type: 'improvisation', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ' },
                { id: 'improv_100h', name: 'Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ: 100 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸ†', type: 'improvisation', threshold: 6000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 100 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð¼Ð¿Ñ€Ð¾Ð²Ð¸Ð·Ð°Ñ†Ð¸Ñ' },
                { id: 'theory_1h', name: 'Ð¢ÐµÐ¾Ñ€Ð¸Ñ: 1 Ñ‡Ð°Ñ', icon: 'ðŸ“š', type: 'theory', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¢ÐµÐ¾Ñ€Ð¸Ñ' },
                { id: 'theory_10h', name: 'Ð¢ÐµÐ¾Ñ€Ð¸Ñ: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸ“–', type: 'theory', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¢ÐµÐ¾Ñ€Ð¸Ñ' },
                { id: 'songs_1h', name: 'ÐŸÐµÑÐ½Ð¸: 1 Ñ‡Ð°Ñ', icon: 'ðŸŽµ', type: 'songs', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð³Ñ€Ð° Ð¿ÐµÑÐµÐ½' },
                { id: 'songs_10h', name: 'ÐŸÐµÑÐ½Ð¸: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŽ¤', type: 'songs', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð³Ñ€Ð° Ð¿ÐµÑÐµÐ½' },
                { id: 'songs_100h', name: 'ÐŸÐµÑÐ½Ð¸: 100 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŒŸ', type: 'songs', threshold: 6000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 100 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð˜Ð³Ñ€Ð° Ð¿ÐµÑÐµÐ½' },
                { id: 'ear_1h', name: 'Ð¡Ð»ÑƒÑ…: 1 Ñ‡Ð°Ñ', icon: 'ðŸ‘‚', type: 'earTraining', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ðµ ÑÐ»ÑƒÑ…Ð°' },
                { id: 'ear_10h', name: 'Ð¡Ð»ÑƒÑ…: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŽ§', type: 'earTraining', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ðµ ÑÐ»ÑƒÑ…Ð°' },
                { id: 'other_1h', name: 'ÐŸÑ€Ð¾Ñ‡ÐµÐµ: 1 Ñ‡Ð°Ñ', icon: 'ðŸŽ¼', type: 'other', threshold: 60, xp: 20, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1 Ñ‡Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÐŸÑ€Ð¾Ñ‡ÐµÐµ' },
                { id: 'other_10h', name: 'ÐŸÑ€Ð¾Ñ‡ÐµÐµ: 10 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸŽ¹', type: 'other', threshold: 600, xp: 50, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 10 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÐŸÑ€Ð¾Ñ‡ÐµÐµ' },
                { id: 'total_100h', name: 'Ð’ÑÐµÐ³Ð¾: 100 Ñ‡Ð°ÑÐ¾Ð²', icon: 'â­', checkFunc: () => getTotalPracticeMinutes() >= 6000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 100 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ ÑÑƒÐ¼Ð¼Ð°Ñ€Ð½Ð¾ Ð¿Ð¾ Ð²ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼' },
                { id: 'total_500h', name: 'Ð’ÑÐµÐ³Ð¾: 500 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸ’«', checkFunc: () => getTotalPracticeMinutes() >= 30000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 500 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ ÑÑƒÐ¼Ð¼Ð°Ñ€Ð½Ð¾ Ð¿Ð¾ Ð²ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼' },
                { id: 'total_1000h', name: 'Ð’ÑÐµÐ³Ð¾: 1000 Ñ‡Ð°ÑÐ¾Ð²', icon: 'ðŸ†', checkFunc: () => getTotalPracticeMinutes() >= 60000, xp: 100, desc: 'ÐÐ°Ð±ÐµÑ€Ð¸ 1000 Ñ‡Ð°ÑÐ¾Ð² Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ ÑÑƒÐ¼Ð¼Ð°Ñ€Ð½Ð¾ Ð¿Ð¾ Ð²ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼' },
                { id: 'level_10', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 10 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 10, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ 10 ÑƒÑ€Ð¾Ð²Ð½Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' },
                { id: 'level_20', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 20 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 20, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ 20 ÑƒÑ€Ð¾Ð²Ð½Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' },
                { id: 'level_40', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 40 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 40, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ 40 ÑƒÑ€Ð¾Ð²Ð½Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' },
                { id: 'level_60', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 60 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 60, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ 60 ÑƒÑ€Ð¾Ð²Ð½Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' },
                { id: 'level_80', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 80 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 80, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ 80 ÑƒÑ€Ð¾Ð²Ð½Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' },
                { id: 'level_100', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð³ 100 ÑƒÑ€Ð¾Ð²Ð½Ñ', icon: 'ðŸŽ–ï¸', checkFunc: () => getLevelInfo().level >= 100, xp: 0, desc: 'Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½Ð¸ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ 100 ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°' }
            ];

            const getUnlockedAchievements = () => { const streak = calculateStreak(); return achievements.filter(a => a.checkFunc ? a.checkFunc() : a.type === 'streak' ? streak >= a.threshold : a.technique ? getTechniqueMinutes(a.technique) >= a.threshold : getCategoryMinutes(a.type) >= a.threshold); };
            
            const savePracticeEntry = (category, minutes, details, sourceLink, selectedTechniques, selectedApproaches, tempo) => {
                const dateKey = formatDateKey(selectedDate);
                setPracticeData(prev => ({ ...prev, [dateKey]: { ...prev[dateKey], entries: [...(prev[dateKey]?.entries || []), { id: Date.now(), category, minutes: parseInt(minutes), details, sourceLink, selectedTechniques, selectedApproaches, tempo, timestamp: new Date().toISOString() }] } }));
            };

            const deleteEntry = (dateKey, entryId) => {
                if ((tg.showConfirm && tg.showConfirm('Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ?', () => {})) || confirm('Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ?')) {
                    setPracticeData(prev => { const newData = { ...prev }; if (newData[dateKey]) { newData[dateKey].entries = newData[dateKey].entries.filter(e => e.id !== entryId); if (newData[dateKey].entries.length === 0) delete newData[dateKey]; } return newData; });
                }
            };

            const handleDateClick = (day) => { setSelectedDate(new Date(currentDate.getFullYear(), currentDate.getMonth(), day)); setShowModal(true); };

            const renderCalendar = () => {
                const { daysInMonth, startingDayOfWeek } = getDaysInMonth(currentDate);
                const days = [];
                ['ÐŸÐ½', 'Ð’Ñ‚', 'Ð¡Ñ€', 'Ð§Ñ‚', 'ÐŸÑ‚', 'Ð¡Ð±', 'Ð’Ñ'].forEach(d => days.push(<div key={`h-${d}`} className="text-center font-semibold text-gray-600 p-2 text-xs">{d}</div>));
                for (let i = 0; i < startingDayOfWeek; i++) days.push(<div key={`e-${i}`} className="p-2"></div>);
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateKey = formatDateKey(new Date(currentDate.getFullYear(), currentDate.getMonth(), day));
                    const totalMinutes = getTotalMinutes(dateKey);
                    days.push(
                        <div key={day} onClick={() => handleDateClick(day)} className={`calendar-day p-2 border rounded-lg h-16 flex flex-col ${totalMinutes > 0 ? 'bg-gradient-to-br from-amber-50 to-orange-50 border-orange-200' : 'border-gray-200'}`}>
                            <div className="font-semibold text-gray-700 text-xs">{day}</div>
                            {totalMinutes > 0 && <div className="text-xs mt-auto text-orange-600 font-semibold">{totalMinutes}Ð¼</div>}
                        </div>
                    );
                }
                return days;
            };

            const PracticeModal = () => {
                const [activeCategory, setActiveCategory] = useState('techniques');
                const [minutes, setMinutes] = useState('');
                const [notes, setNotes] = useState('');
                const [sourceLink, setSourceLink] = useState('');
                const [selectedSubcategories, setSelectedSubcategories] = useState([]);
                const [tempo, setTempo] = useState('');
                
                if (!showModal || !selectedDate) return null;
                const dateKey = formatDateKey(selectedDate);
                const existingEntries = practiceData[dateKey]?.entries || [];
                
                const handleSave = () => {
                    if (!minutes) return alert('Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð²Ñ€ÐµÐ¼Ñ');
                    let details = notes;
                    let subcatsToSave = selectedSubcategories.length > 0 ? selectedSubcategories : [];
                    
                    if (selectedSubcategories.length > 0) {
                        details = `${selectedSubcategories.join(', ')}${notes ? ' | ' + notes : ''}`;
                    }
                    
                    if (activeCategory === 'techniques' && tempo) {
                        details += ` | Ð¢ÐµÐ¼Ð¿: ${tempo} bpm`;
                    }
                    
                    savePracticeEntry(activeCategory, minutes, details, sourceLink, subcatsToSave, [], tempo || '');
                    setMinutes(''); setNotes(''); setSourceLink(''); setSelectedSubcategories([]); setTempo('');
                };
                
                const currentSubcategories = subcategories[activeCategory] || [];
                
                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                            <div className="bg-gradient-to-r from-purple-600 to-orange-600 text-white p-4 flex justify-between rounded-t-xl">
                                <h2 className="text-lg font-bold">{selectedDate.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })}</h2>
                                <button onClick={() => setShowModal(false)} className="text-2xl">âœ•</button>
                            </div>
                            <div className="p-4">
                                <div className="flex gap-2 mb-4 overflow-x-auto">
                                    {Object.entries(categories).map(([key, cat]) => (
                                        <button key={key} onClick={() => { setActiveCategory(key); setSelectedSubcategories([]); }} className={`px-3 py-2 rounded-lg text-xs whitespace-nowrap ${activeCategory === key ? `${cat.color} text-white` : 'bg-gray-100'}`}>
                                            {cat.icon} {cat.name}
                                        </button>
                                    ))}
                                </div>
                                <div className="space-y-3 mb-4">
                                    <input type="number" value={minutes} onChange={(e) => setMinutes(e.target.value)} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="ÐœÐ¸Ð½ÑƒÑ‚Ñ‹" />
                                    
                                    {currentSubcategories.length > 0 && (
                                        <div className="max-h-32 overflow-y-auto border rounded-lg p-2">
                                            {currentSubcategories.map(subcat => (
                                                <label key={subcat} className="flex items-center gap-2 p-1 text-xs cursor-pointer">
                                                    <input type="checkbox" checked={selectedSubcategories.includes(subcat)} onChange={(e) => setSelectedSubcategories(e.target.checked ? [...selectedSubcategories, subcat] : selectedSubcategories.filter(s => s !== subcat))} />
                                                    <span>{subcat}</span>
                                                </label>
                                            ))}
                                        </div>
                                    )}
                                    
                                    {activeCategory === 'techniques' && (
                                        <input type="number" value={tempo} onChange={(e) => setTempo(e.target.value)} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="Ð¢ÐµÐ¼Ð¿ (BPM)" />
                                    )}
                                    
                                    <textarea value={notes} onChange={(e) => setNotes(e.target.value)} className="w-full px-3 py-2 border rounded-lg text-sm" rows="2" placeholder="Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸"></textarea>
                                    <input type="url" value={sourceLink} onChange={(e) => setSourceLink(e.target.value)} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="Ð¡ÑÑ‹Ð»ÐºÐ° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)" />
                                    <button onClick={handleSave} className="w-full bg-gradient-to-r from-purple-600 to-orange-600 text-white py-3 rounded-lg font-bold">Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ</button>
                                </div>
                                {existingEntries.length > 0 && (
                                    <div className="border-t pt-4">
                                        <h3 className="font-bold text-sm mb-3">Ð—Ð°Ð¿Ð¸ÑÐ¸ ({existingEntries.length})</h3>
                                        {existingEntries.map(entry => (
                                            <div key={entry.id} className="mb-3 p-3 bg-gray-50 rounded-lg text-sm">
                                                <div className="flex justify-between">
                                                    <div>
                                                        <div className="font-semibold">{categories[entry.category]?.icon} {entry.minutes} Ð¼Ð¸Ð½</div>
                                                        {entry.details && <div className="text-xs text-gray-600 mt-1">{entry.details}</div>}
                                                        {entry.sourceLink && <a href={entry.sourceLink} target="_blank" rel="noopener noreferrer" className="text-xs text-blue-600 hover:underline">ðŸ”— Ð¡ÑÑ‹Ð»ÐºÐ°</a>}
                                                    </div>
                                                    <button onClick={() => deleteEntry(dateKey, entry.id)} className="text-red-500">âœ•</button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            const CalendarView = () => {
                const top3 = getTop3Techniques();
                const sorted = getSortedCategories();
                return (
                    <>
                        <div className="bg-white rounded-xl shadow-lg p-4 mb-4">
                            <div className="flex justify-between items-center">
                                <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1))} className="px-3 py-2 bg-purple-600 text-white rounded-lg text-sm">â†</button>
                                <h2 className="text-xl font-bold">{['Ð¯Ð½Ð²Ð°Ñ€ÑŒ', 'Ð¤ÐµÐ²Ñ€Ð°Ð»ÑŒ', 'ÐœÐ°Ñ€Ñ‚', 'ÐÐ¿Ñ€ÐµÐ»ÑŒ', 'ÐœÐ°Ð¹', 'Ð˜ÑŽÐ½ÑŒ', 'Ð˜ÑŽÐ»ÑŒ', 'ÐÐ²Ð³ÑƒÑÑ‚', 'Ð¡ÐµÐ½Ñ‚ÑÐ±Ñ€ÑŒ', 'ÐžÐºÑ‚ÑÐ±Ñ€ÑŒ', 'ÐÐ¾ÑÐ±Ñ€ÑŒ', 'Ð”ÐµÐºÐ°Ð±Ñ€ÑŒ'][currentDate.getMonth()]} {currentDate.getFullYear()}</h2>
                                <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1))} className="px-3 py-2 bg-orange-600 text-white rounded-lg text-sm">â†’</button>
                            </div>
                        </div>
                        <div className="bg-white rounded-xl shadow-lg p-4 mb-4"><div className="grid grid-cols-7 gap-1">{renderCalendar()}</div></div>
                        <div className="bg-gradient-to-r from-purple-100 to-orange-100 rounded-xl p-4 mb-4 text-center">
                            <div className="text-xs text-gray-600 mb-1">ðŸ’­ ÐœÐ¾Ñ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ð´Ð½Ñ</div>
                            <div className="text-sm font-semibold italic">"{dailyQuote}"</div>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-lg font-bold mb-3">ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°</h3>
                                <div className="space-y-2">
                                    <div className="flex items-center gap-2 p-2 bg-gradient-to-r from-orange-50 to-red-50 rounded-lg">
                                        <span className="text-2xl">ðŸ”¥</span>
                                        <div><div className="text-xs text-gray-600">Ð”Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´</div><div className="text-lg font-bold text-orange-600">{calculateStreak()}</div></div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-2">
                                        <div className="p-2 bg-blue-50 rounded-lg"><div className="text-xs text-gray-600">Ð—Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ</div><div className="text-base font-bold text-blue-600">{getMinutesThisWeek()}Ð¼</div></div>
                                        <div className="p-2 bg-indigo-50 rounded-lg"><div className="text-xs text-gray-600">Ð—Ð° Ð¼ÐµÑÑÑ†</div><div className="text-base font-bold text-indigo-600">{getMinutesThisMonth()}Ð¼</div></div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-2">
                                        <div className="p-2 bg-green-50 rounded-lg"><div className="text-xs text-gray-600">Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ/Ð´ÐµÐ½ÑŒ (Ð½ÐµÐ´)</div><div className="text-base font-bold text-green-600">{Math.round(getMinutesThisWeek() / 7)}Ð¼</div></div>
                                        <div className="p-2 bg-teal-50 rounded-lg"><div className="text-xs text-gray-600">Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ/Ð´ÐµÐ½ÑŒ (Ð¼ÐµÑ)</div><div className="text-base font-bold text-teal-600">{Math.round(getMinutesThisMonth() / new Date().getDate())}Ð¼</div></div>
                                    </div>
                                    {top3.length > 0 && (
                                        <div className="p-2 bg-purple-50 rounded-lg">
                                            <div className="text-xs text-gray-600 mb-1 font-semibold">ðŸŽ¯ Ð¢Ð¾Ð¿-3 ÑÐ°Ð¼Ñ‹Ñ… Ñ‡Ð°ÑÑ‚Ñ‹Ñ… Ñ‚ÐµÑ…Ð½Ð¸Ðº:</div>
                                            {top3.map((t, i) => <div key={t.name} className="text-xs">{i + 1}. {t.name.split('(')[0]} - <span className="font-bold">{t.minutes}Ð¼</span></div>)}
                                        </div>
                                    )}
                                </div>
                            </div>
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-lg font-bold mb-3">ðŸŽ¯ ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ</h3>
                                <div className="space-y-2">
                                    {sorted.map(cat => (
                                        <div key={cat.key} className="p-2 bg-gray-50 rounded-lg">
                                            <div className="flex justify-between mb-1">
                                                <div className="flex items-center gap-2"><div className={`w-2 h-2 rounded-full ${cat.color}`}></div><span className="text-xs font-semibold">{cat.icon} {cat.name}</span></div>
                                                <span className="text-xs text-gray-500">{Math.floor(cat.minutes / 60)}Ñ‡ {cat.minutes % 60}Ð¼</span>
                                            </div>
                                            <div className="w-full bg-gray-200 rounded-full h-1"><div className={`${cat.color} h-1 rounded-full`} style={{ width: `${Math.min((cat.minutes / (getTotalPracticeMinutes() || 1)) * 100, 100)}%` }}></div></div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </>
                );
            };

            const AchievementsView = () => {
                const unlocked = getUnlockedAchievements();
                return (
                    <>
                        <div className="bg-white rounded-xl shadow-lg p-4">
                            <h3 className="text-xl font-bold mb-4">ðŸ† Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ ({unlocked.length}/{achievements.length})</h3>
                            <div className="grid grid-cols-3 md:grid-cols-6 gap-2">
                                {achievements.map(a => {
                                    const isUnlocked = unlocked.some(u => u.id === a.id);
                                    return (
                                        <div key={a.id} onClick={() => setShowAchievementModal(a)} className={`p-2 rounded-lg text-center cursor-pointer transition-transform hover:scale-105 ${isUnlocked ? 'bg-gradient-to-br from-yellow-100 to-orange-100 border-2 border-yellow-400' : 'bg-gray-100 opacity-40 grayscale'}`}>
                                            <div className="text-2xl mb-1">{a.icon}</div>
                                            <div className="text-xs font-semibold leading-tight">{a.name}</div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                        {showAchievementModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowAchievementModal(null)}>
                                <div className="bg-white rounded-xl max-w-md w-full p-6" onClick={(e) => e.stopPropagation()}>
                                    <div className="text-center">
                                        <div className="text-6xl mb-4">{showAchievementModal.icon}</div>
                                        <h3 className="text-2xl font-bold mb-2">{showAchievementModal.name}</h3>
                                        <p className="text-gray-600 mb-4">{showAchievementModal.desc}</p>
                                        <div className="text-sm text-purple-600 font-semibold mb-4">+{showAchievementModal.xp} Ð¾Ð¿Ñ‹Ñ‚Ð°</div>
                                        <button onClick={() => setShowAchievementModal(null)} className="w-full bg-gradient-to-r from-purple-600 to-orange-600 text-white py-3 rounded-lg font-bold">Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ</button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </>
                );
            };

            const HistoryView = () => {
                // Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð²ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¸Ð· practiceData Ð² Ñ…Ñ€Ð¾Ð½Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼ Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ
                const historyEntries = [];
                
                Object.keys(practiceData).forEach(dateKey => {
                    const dayData = practiceData[dateKey];
                    if (dayData && dayData.entries) {
                        dayData.entries.forEach(entry => {
                            historyEntries.push({
                                ...entry,
                                dateKey: dateKey,
                                date: new Date(entry.timestamp || dateKey)
                            });
                        });
                    }
                });
                
                // Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ Ð´Ð°Ñ‚Ðµ (Ð½Ð¾Ð²Ñ‹Ðµ ÑÐ²ÐµÑ€Ñ…Ñƒ)
                historyEntries.sort((a, b) => b.date - a.date);
                
                return (
                    <div className="bg-white rounded-xl shadow-lg p-4">
                        <h3 className="text-xl font-bold mb-4">ðŸ“œ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ ({historyEntries.length})</h3>
                        {historyEntries.length === 0 ? (
                            <div className="text-center text-gray-500 py-8">
                                <div className="text-4xl mb-2">ðŸ“</div>
                                <div>Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð¿ÑƒÑÑ‚Ð°</div>
                                <div className="text-sm mt-1">Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð² Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐµ!</div>
                            </div>
                        ) : (
                            <div className="space-y-3 max-h-[600px] overflow-y-auto">
                                {historyEntries.map((entry, idx) => (
                                    <div key={entry.id || idx} className="p-3 bg-gradient-to-r from-purple-50 to-orange-50 rounded-lg border-l-4 border-purple-500">
                                        <div className="flex justify-between items-start mb-2">
                                            <div className="flex items-center gap-2">
                                                <span className="text-2xl">{categories[entry.category]?.icon}</span>
                                                <div>
                                                    <div className="font-semibold text-gray-800">{categories[entry.category]?.name}</div>
                                                    <div className="text-xs text-gray-600">
                                                        {new Date(entry.date).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' })} 
                                                        {' Ð² '} 
                                                        {new Date(entry.date).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="text-right">
                                                <div className="font-bold text-orange-600">{entry.minutes} Ð¼Ð¸Ð½</div>
                                            </div>
                                        </div>
                                        {entry.details && (
                                            <div className="text-sm text-gray-700 mt-2 bg-white bg-opacity-50 p-2 rounded">
                                                {entry.details}
                                            </div>
                                        )}
                                        {entry.sourceLink && (
                                            <a href={entry.sourceLink} target="_blank" rel="noopener noreferrer" className="text-xs text-blue-600 hover:underline mt-1 inline-block">
                                                ðŸ”— Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»
                                            </a>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                );
            };

            const NotesView = () => {
                const [newLearned, setNewLearned] = useState('');
                const [newToLearn, setNewToLearn] = useState('');
                const [currentTempo, setCurrentTempo] = useState('');
                const [targetTempo, setTargetTempo] = useState('');
                const [newNote, setNewNote] = useState('');
                
                return (
                    <>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div className="bg-white rounded-xl shadow-lg p-4 cursor-pointer hover:shadow-xl transition-shadow" onClick={() => setShowLearnedSongsModal(true)}>
                                <h3 className="text-lg font-bold mb-2">âœ… Ð’Ñ‹ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ</h3>
                                <div className="text-3xl font-bold text-green-600">{learnedSongs.length}</div>
                                <p className="text-sm text-gray-600 mt-2">ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°</p>
                            </div>
                            
                            <div className="bg-white rounded-xl shadow-lg p-4 cursor-pointer hover:shadow-xl transition-shadow" onClick={() => setShowToLearnSongsModal(true)}>
                                <h3 className="text-lg font-bold mb-2">ðŸŽ¯ ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÑŽ</h3>
                                <div className="text-3xl font-bold text-blue-600">{toLearnSongs.length}</div>
                                <p className="text-sm text-gray-600 mt-2">ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°</p>
                            </div>
                            
                            <div className="bg-white rounded-xl shadow-lg p-4 cursor-pointer hover:shadow-xl transition-shadow" onClick={() => setShowNotesModal(true)}>
                                <h3 className="text-lg font-bold mb-2">ðŸ“ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸</h3>
                                <div className="text-3xl font-bold text-purple-600">{notes.length}</div>
                                <p className="text-sm text-gray-600 mt-2">ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°</p>
                            </div>
                        </div>
                        
                        {showLearnedSongsModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowLearnedSongsModal(false)}>
                                <div className="bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6" onClick={(e) => e.stopPropagation()}>
                                    <h3 className="text-xl font-bold mb-4">âœ… Ð’Ñ‹ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÐµÑÐ½Ð¸ ({learnedSongs.length})</h3>
                                    <div className="space-y-2 mb-4">
                                        {learnedSongs.map((s, i) => (
                                            <div key={i} className="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                                                <div>
                                                    <div className="font-semibold">{s.name}</div>
                                                    <div className="text-xs text-gray-600">Ð’Ñ‹ÑƒÑ‡ÐµÐ½Ð°: {new Date(s.date).toLocaleDateString('ru-RU')}</div>
                                                </div>
                                                <button onClick={() => setLearnedSongs(learnedSongs.filter((_, idx) => idx !== i))} className="text-red-500 px-2">âœ•</button>
                                            </div>
                                        ))}
                                        {learnedSongs.length === 0 && <div className="text-center text-gray-500 py-4">ÐÐµÑ‚ Ð²Ñ‹ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÐµÑÐµÐ½</div>}
                                    </div>
                                    <div className="flex gap-2 mb-4">
                                        <input type="text" value={newLearned} onChange={(e) => setNewLearned(e.target.value)} placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑÐ½Ð¸" className="flex-1 px-3 py-2 border rounded-lg" onKeyPress={(e) => e.key === 'Enter' && newLearned && (setLearnedSongs([...learnedSongs, { name: newLearned, date: new Date().toISOString() }]), setNewLearned(''))} />
                                        <button onClick={() => newLearned && (setLearnedSongs([...learnedSongs, { name: newLearned, date: new Date().toISOString() }]), setNewLearned(''))} className="px-4 py-2 bg-green-600 text-white rounded-lg">Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ</button>
                                    </div>
                                    <button onClick={() => setShowLearnedSongsModal(false)} className="w-full bg-gray-600 text-white py-3 rounded-lg font-bold">Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ</button>
                                </div>
                            </div>
                        )}
                        
                        {showToLearnSongsModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowToLearnSongsModal(false)}>
                                <div className="bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6" onClick={(e) => e.stopPropagation()}>
                                    <h3 className="text-xl font-bold mb-4">ðŸŽ¯ ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÑŽ Ð²Ñ‹ÑƒÑ‡Ð¸Ñ‚ÑŒ ({toLearnSongs.length})</h3>
                                    <div className="space-y-2 mb-4">
                                        {toLearnSongs.map((s, i) => (
                                            <div key={i} className="p-3 bg-blue-50 rounded-lg">
                                                <div className="flex justify-between items-start mb-2">
                                                    <div>
                                                        <div className="font-semibold">{s.name}</div>
                                                        <div className="text-sm text-gray-600">Ð¢ÐµÐ¼Ð¿: {s.currentTempo} â†’ {s.targetTempo} bpm</div>
                                                        <div className="text-xs text-gray-600">Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°: {new Date(s.date).toLocaleDateString('ru-RU')}</div>
                                                    </div>
                                                    <button onClick={() => setToLearnSongs(toLearnSongs.filter((_, idx) => idx !== i))} className="text-red-500 px-2">âœ•</button>
                                                </div>
                                            </div>
                                        ))}
                                        {toLearnSongs.length === 0 && <div className="text-center text-gray-500 py-4">ÐÐµÑ‚ Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ñ… Ð¿ÐµÑÐµÐ½</div>}
                                    </div>
                                    <div className="space-y-2 mb-4">
                                        <input type="text" value={newToLearn} onChange={(e) => setNewToLearn(e.target.value)} placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑÐ½Ð¸" className="w-full px-3 py-2 border rounded-lg" />
                                        <div className="grid grid-cols-2 gap-2">
                                            <input type="number" value={currentTempo} onChange={(e) => setCurrentTempo(e.target.value)} placeholder="Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‚ÐµÐ¼Ð¿" className="px-3 py-2 border rounded-lg" />
                                            <input type="number" value={targetTempo} onChange={(e) => setTargetTempo(e.target.value)} placeholder="Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ Ñ‚ÐµÐ¼Ð¿" className="px-3 py-2 border rounded-lg" />
                                        </div>
                                        <button onClick={() => newToLearn && (setToLearnSongs([...toLearnSongs, { name: newToLearn, currentTempo: currentTempo || '0', targetTempo: targetTempo || '120', date: new Date().toISOString() }]), setNewToLearn(''), setCurrentTempo(''), setTargetTempo(''))} className="w-full px-3 py-2 bg-blue-600 text-white rounded-lg">Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ</button>
                                    </div>
                                    <button onClick={() => setShowToLearnSongsModal(false)} className="w-full bg-gray-600 text-white py-3 rounded-lg font-bold">Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ</button>
                                </div>
                            </div>
                        )}
                        
                        {showNotesModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowNotesModal(false)}>
                                <div className="bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6" onClick={(e) => e.stopPropagation()}>
                                    <h3 className="text-xl font-bold mb-4">ðŸ“ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸ ({notes.length})</h3>
                                    <div className="space-y-2 mb-4">
                                        {notes.map((note, i) => (
                                            <div key={i} className="p-3 bg-purple-50 rounded-lg">
                                                <div className="flex justify-between items-start mb-2">
                                                    <div className="flex-1">
                                                        <div className="text-sm whitespace-pre-wrap">{note.text}</div>
                                                        <div className="text-xs text-gray-600 mt-1">{new Date(note.date).toLocaleDateString('ru-RU')} {new Date(note.date).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}</div>
                                                    </div>
                                                    <button onClick={() => setNotes(notes.filter((_, idx) => idx !== i))} className="text-red-500 px-2">âœ•</button>
                                                </div>
                                            </div>
                                        ))}
                                        {notes.length === 0 && <div className="text-center text-gray-500 py-4">ÐÐµÑ‚ Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº</div>}
                                    </div>
                                    <div className="space-y-2 mb-4">
                                        <textarea value={newNote} onChange={(e) => setNewNote(e.target.value)} placeholder="ÐÐ¾Ð²Ð°Ñ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ°..." className="w-full px-3 py-2 border rounded-lg" rows="3"></textarea>
                                        <button onClick={() => newNote && (setNotes([...notes, { id: Date.now(), text: newNote, date: new Date().toISOString() }]), setNewNote(''))} className="w-full px-3 py-2 bg-purple-600 text-white rounded-lg">Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ</button>
                                    </div>
                                    <button onClick={() => setShowNotesModal(false)} className="w-full bg-gray-600 text-white py-3 rounded-lg font-bold">Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ</button>
                                </div>
                            </div>
                        )}
                    </>
                );
            };

            const ProfileView = () => {
                const [editingName, setEditingName] = useState(false);
                const [newName, setNewName] = useState(userProfile.username);
                const [localSearchName, setLocalSearchName] = useState('');
                const unlocked = getUnlockedAchievements();
                
                const addFriend = () => {
                    const trimmedName = localSearchName.trim();
                    if (!trimmedName) {
                        if (tg.showAlert) tg.showAlert('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ');
                        return;
                    }
                    
                    if (friends.some(f => f.username.toLowerCase() === trimmedName.toLowerCase())) {
                        if (tg.showAlert) tg.showAlert('Ð­Ñ‚Ð¾Ñ‚ Ð´Ñ€ÑƒÐ³ ÑƒÐ¶Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½!');
                        return;
                    }
                    
                    if (trimmedName.toLowerCase() === userProfile.username.toLowerCase()) {
                        if (tg.showAlert) tg.showAlert('ÐÐµÐ»ÑŒÐ·Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ°Ð¼Ð¾Ð³Ð¾ ÑÐµÐ±Ñ!');
                        return;
                    }
                    
                    setFriends([...friends, { username: trimmedName, since: new Date().toISOString() }]);
                    if (tg.showAlert) tg.showAlert(`Ð”Ñ€ÑƒÐ³ ${trimmedName} Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½!`);
                    setLocalSearchName('');
                };
                
                return (
                    <div className="space-y-4">
                        <div className="bg-white rounded-xl shadow-lg p-4">
                            <div className="flex items-center gap-4 mb-4">
                                <div className="w-16 h-16 bg-gradient-to-br from-purple-600 to-orange-600 rounded-full flex items-center justify-center text-white text-2xl font-bold overflow-hidden">
                                    {userProfile.avatar ? <img src={userProfile.avatar} className="w-full h-full object-cover" alt="Avatar" /> : userProfile.username[0]?.toUpperCase()}
                                </div>
                                <div className="flex-1">
                                    {editingName ? (
                                        <div className="flex gap-2">
                                            <input type="text" value={newName} onChange={(e) => setNewName(e.target.value)} className="flex-1 px-3 py-2 border rounded-lg text-sm" />
                                            <button onClick={() => {setUserProfile({...userProfile, username: newName}); setEditingName(false);}} className="px-3 py-2 bg-green-600 text-white rounded-lg text-sm">âœ“</button>
                                        </div>
                                    ) : (
                                        <div className="flex items-center gap-2">
                                            <h2 className="text-xl font-bold">{userProfile.username}</h2>
                                            <button onClick={() => setEditingName(true)} className="text-blue-600 text-sm">âœï¸</button>
                                        </div>
                                    )}
                                    <div className="text-xs text-gray-600">Ð¡ {new Date(userProfile.registrationDate).toLocaleDateString('ru-RU')}</div>
                                </div>
                            </div>
                            <div className="mb-4 p-3 bg-gradient-to-r from-purple-50 to-orange-50 rounded-lg">
                                <div className="flex justify-between items-center mb-2">
                                    <div>
                                        <div className="text-lg font-bold text-purple-600">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ {getLevelInfo().level}</div>
                                        <div className="text-xs text-gray-600">{getLevelInfo().rank}</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-xs text-gray-600">ÐžÐ¿Ñ‹Ñ‚</div>
                                        <div className="text-sm font-semibold">{getLevelInfo().currentXP} / {getLevelInfo().nextLevelXP}</div>
                                    </div>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div className="bg-gradient-to-r from-purple-600 to-orange-600 h-2 rounded-full transition-all duration-500" style={{width: `${getLevelInfo().progress}%`}}></div>
                                </div>
                            </div>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2 mb-4">
                                <div className="p-2 bg-orange-50 rounded-lg"><div className="text-xs text-gray-600">Ð”Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´</div><div className="text-base font-bold text-orange-600">{calculateStreak()}</div></div>
                                <div className="p-2 bg-red-50 rounded-lg"><div className="text-xs text-gray-600">ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼</div><div className="text-base font-bold text-red-600">{calculateMaxStreak()}</div></div>
                                <div className="p-2 bg-purple-50 rounded-lg"><div className="text-xs text-gray-600">Ð’ÑÐµÐ³Ð¾</div><div className="text-base font-bold text-purple-600">{Math.floor(getTotalPracticeMinutes() / 60)}Ñ‡ {getTotalPracticeMinutes() % 60}Ð¼</div></div>
                                <div className="p-2 bg-blue-50 rounded-lg"><div className="text-xs text-gray-600">Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¹</div><div className="text-base font-bold text-blue-600">{unlocked.length}/{achievements.length}</div></div>
                            </div>
                            <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <div><div className="font-semibold text-sm">Ð¢Ñ‘Ð¼Ð½Ð°Ñ Ñ‚ÐµÐ¼Ð°</div><div className="text-xs text-gray-600">ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ</div></div>
                                <label className="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" checked={darkTheme} onChange={(e) => setDarkTheme(e.target.checked)} className="sr-only peer" />
                                    <div className="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                                </label>
                            </div>
                        </div>
                        <div className="bg-white rounded-xl shadow-lg p-4">
                            <h3 className="text-lg font-bold mb-3">ðŸ‘¥ Ð”Ñ€ÑƒÐ·ÑŒÑ ({friends.length})</h3>
                            <div className="flex gap-2 mb-3">
                                <input 
                                    type="text" 
                                    value={localSearchName} 
                                    onChange={(e) => setLocalSearchName(e.target.value)} 
                                    onKeyPress={(e) => e.key === 'Enter' && addFriend()}
                                    placeholder="Ð˜Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ" 
                                    className="flex-1 px-3 py-2 border rounded-lg text-sm" 
                                />
                                <button onClick={addFriend} className="px-3 py-2 bg-blue-600 text-white rounded-lg text-sm whitespace-nowrap">Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ</button>
                            </div>
                            {friends.length > 0 && (
                                <div className="space-y-2">
                                    {friends.map((friend, idx) => (
                                        <div key={idx} className="flex justify-between items-center p-2 bg-gray-50 rounded-lg">
                                            <div className="flex-1">
                                                <div className="font-semibold text-sm">{friend.username}</div>
                                                <div className="text-xs text-gray-600">Ð”Ñ€ÑƒÐ¶Ð¸Ñ‚Ðµ Ñ {new Date(friend.since).toLocaleDateString('ru-RU')}</div>
                                            </div>
                                            <div className="flex gap-2">
                                                <button onClick={() => setViewingFriend(friend)} className="px-3 py-1 bg-purple-600 text-white rounded text-xs">ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ</button>
                                                <button onClick={() => setFriends(friends.filter((_, i) => i !== idx))} className="text-red-500 text-sm px-2">âœ•</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                            {friends.length === 0 && <div className="text-center text-gray-500 text-sm py-4">Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð´Ñ€ÑƒÐ·ÐµÐ¹!</div>}
                        </div>
                    </div>
                );
            };

            const tabs = [
                { id: 'calendar', name: 'Ð”Ð½ÐµÐ²Ð½Ð¸Ðº', icon: 'ðŸ“…' },
                { id: 'history', name: 'Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ', icon: 'ðŸ“œ' },
                { id: 'notes', name: 'Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸', icon: 'ðŸ“' },
                { id: 'achievements', name: 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ', icon: 'ðŸ†' },
                { id: 'profile', name: 'ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ', icon: 'ðŸ‘¤' }
            ];

            if (loading) return <div className="flex items-center justify-center h-screen"><div className="text-2xl">â³ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...</div></div>;

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 to-orange-50 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-xl shadow-lg p-4 mb-4">
                            <div className="flex justify-between items-center mb-3">
                                <h1 className="text-base sm:text-lg md:text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-orange-600 leading-tight">ðŸŽ¸ ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ Ð³Ð¸Ñ‚Ð°Ñ€Ð½Ð¾Ð¹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸</h1>
                                <div className="flex items-center gap-2">
                                    <div className="w-8 h-8 bg-gradient-to-br from-purple-600 to-orange-600 rounded-full flex items-center justify-center text-white text-sm font-bold overflow-hidden">
                                        {userProfile.avatar ? <img src={userProfile.avatar} className="w-full h-full object-cover" alt="Avatar" /> : userProfile.username[0]?.toUpperCase()}
                                    </div>
                                    <span className="text-sm font-semibold">{userProfile.username}</span>
                                </div>
                            </div>
                            <div className="flex gap-2 overflow-x-auto">
                                {tabs.map(tab => (
                                    <button key={tab.id} onClick={() => setCurrentTab(tab.id)} className={`px-3 py-2 rounded-lg font-semibold text-sm whitespace-nowrap ${currentTab === tab.id ? 'bg-gradient-to-r from-purple-600 to-orange-600 text-white' : 'bg-gray-100'}`}>
                                        {tab.icon} {tab.name}
                                    </button>
                                ))}
                            </div>
                        </div>
                        {currentTab === 'calendar' && <CalendarView />}
                        {currentTab === 'history' && <HistoryView />}
                        {currentTab === 'achievements' && <AchievementsView />}
                        {currentTab === 'notes' && <NotesView />}
                        {currentTab === 'profile' && <ProfileView />}
                    </div>
                    <PracticeModal />
                    {viewingFriend && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-xl shadow-2xl max-w-md w-full">
                                <div className="bg-gradient-to-r from-purple-600 to-orange-600 text-white p-4 flex justify-between rounded-t-xl">
                                    <h2 className="text-lg font-bold">ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ñ€ÑƒÐ³Ð°</h2>
                                    <button onClick={() => setViewingFriend(null)} className="text-2xl">âœ•</button>
                                </div>
                                <div className="p-6">
                                    <div className="flex items-center gap-4 mb-6">
                                        <div className="w-16 h-16 bg-gradient-to-br from-purple-600 to-orange-600 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                                            {viewingFriend.username[0]?.toUpperCase()}
                                        </div>
                                        <div>
                                            <h3 className="text-xl font-bold">{viewingFriend.username}</h3>
                                            <p className="text-sm text-gray-600">Ð”Ñ€ÑƒÐ¶Ð¸Ñ‚Ðµ Ñ {new Date(viewingFriend.since).toLocaleDateString('ru-RU')}</p>
                                        </div>
                                    </div>
                                    <div className="bg-blue-50 rounded-lg p-4 text-center">
                                        <p className="text-sm text-gray-600 mb-2">ðŸ“Š ÐŸÐ¾Ð»Ð½Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð´Ñ€ÑƒÐ³Ð°</p>
                                        <p className="text-xs text-gray-500">Ð”Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð´Ñ€ÑƒÐ·ÐµÐ¹ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ ÑÐµÑ€Ð²ÐµÑ€Ð½Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ.</p>
                                        <p className="text-xs text-gray-500 mt-2">Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ð² ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ… Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÑÑ…! ðŸš€</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<GuitarPracticeApp />, document.getElementById('root'));
    </script>
</body>
</html>
